- require 'bootstrap-sass'

.container
	%table.table.table-hover
		%thead
			%tr
				%th= "Assignment name"
				%th= "Description"
				%th= "Due Date"
				%th= "Your submission status"
		%tbody
			- current_user.cohorts.each do |c|
				- c.assignments.each do |a|
					%tr
						%td= link_to a.assignment_name, a
						%td= a.description
						-if a.due_date != nil
							%td= a.due_date.strftime("%b %d, %Y")
						-else
							%td= "No record" #Put this in helper method like for todo_sevenhabits_app
						-if cannot? :edit, Assignment
							- @submission = Submission.where(assignment_id: a.id).where(user_id: current_user.id).first
								- if @submission != nil
								%td= link_to "#{@submission.status} on #{@submission.updated_at.strftime("%a (%b %d)")} at #{@submission.updated_at.strftime("%l:%M %p")}", @submission
								/ - else
								/ 	%td Not submitted yet!
						/ - else
						/ 	- @submissions = Submission.where(assignment_id: a.id)
						/ 		- @submission.each do |f|
						/ 			= f.user_id
						


- if can? :create, Assignment
	- if @cohort != nil
		= form_for Assignment.new do |f| # make this not Assignment.new but auto linking to main cohort with hidden field :cohort_id that has value: @cohort.id (use text field first to see what cohort id comes up)
			= f.hidden_field :cohort_id, value: @cohort.id
			= f.label :assignment_name
			= f.text_field :assignment_name
			= f.label :description
			= f.text_field :description
			= f.label :due_date
			= f.date_select :due_date
			.actions
				.form-group
					.col-lg-10.col-lg-offset-2
						= f.submit


- if cannot? :read, Assignment
	= link_to "Register now!", new_user_registration_path
%br
- if cannot? :read, Assignment
	= link_to "Sign in", new_user_session_path
%br
- if can? :read, Assignment
	= link_to "Sign out", destroy_user_session_path, method: :delete